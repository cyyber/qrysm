package attestations

import (
	"encoding/hex"
	"testing"

	"github.com/theQRL/go-bitfield"
	zondpb "github.com/theQRL/qrysm/v4/proto/qrysm/v1alpha1"
	"github.com/theQRL/qrysm/v4/proto/qrysm/v1alpha1/attestation/aggregation"
	"github.com/theQRL/qrysm/v4/testing/assert"
)

func TestAggregateAttestations_MaxCover_NewMaxCover(t *testing.T) {
	type args struct {
		atts []*zondpb.Attestation
	}
	tests := []struct {
		name string
		args args
		want *aggregation.MaxCoverProblem
	}{
		{
			name: "nil attestations",
			args: args{
				atts: nil,
			},
			want: &aggregation.MaxCoverProblem{Candidates: []*aggregation.MaxCoverCandidate{}},
		},
		{
			name: "no attestations",
			args: args{
				atts: []*zondpb.Attestation{},
			},
			want: &aggregation.MaxCoverProblem{Candidates: []*aggregation.MaxCoverCandidate{}},
		},
		{
			name: "single attestation",
			args: args{
				atts: []*zondpb.Attestation{
					{AggregationBits: bitfield.Bitlist{0b00001010, 0b1}},
				},
			},
			want: &aggregation.MaxCoverProblem{
				Candidates: aggregation.MaxCoverCandidates{
					aggregation.NewMaxCoverCandidate(0, &bitfield.Bitlist{0b00001010, 0b1}),
				},
			},
		},
		{
			name: "multiple attestations",
			args: args{
				atts: []*zondpb.Attestation{
					{AggregationBits: bitfield.Bitlist{0b00001010, 0b1}},
					{AggregationBits: bitfield.Bitlist{0b00101010, 0b1}},
					{AggregationBits: bitfield.Bitlist{0b11111010, 0b1}},
					{AggregationBits: bitfield.Bitlist{0b00000010, 0b1}},
					{AggregationBits: bitfield.Bitlist{0b00000001, 0b1}},
				},
			},
			want: &aggregation.MaxCoverProblem{
				Candidates: aggregation.MaxCoverCandidates{
					aggregation.NewMaxCoverCandidate(0, &bitfield.Bitlist{0b00001010, 0b1}),
					aggregation.NewMaxCoverCandidate(1, &bitfield.Bitlist{0b00101010, 0b1}),
					aggregation.NewMaxCoverCandidate(2, &bitfield.Bitlist{0b11111010, 0b1}),
					aggregation.NewMaxCoverCandidate(3, &bitfield.Bitlist{0b00000010, 0b1}),
					aggregation.NewMaxCoverCandidate(4, &bitfield.Bitlist{0b00000001, 0b1}),
				},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			assert.DeepEqual(t, tt.want, NewMaxCover(tt.args.atts))
		})
	}
}

func TestAggregateAttestations_MaxCover_AttList_validate(t *testing.T) {
	tests := []struct {
		name      string
		atts      attList
		wantedErr string
	}{
		{
			name:      "nil list",
			atts:      nil,
			wantedErr: "nil list",
		},
		{
			name:      "empty list",
			atts:      attList{},
			wantedErr: "empty list",
		},
		{
			name:      "first bitlist is nil",
			atts:      attList{&zondpb.Attestation{}},
			wantedErr: "bitlist cannot be nil or empty",
		},
		{
			name: "non first bitlist is nil",
			atts: attList{
				&zondpb.Attestation{AggregationBits: bitfield.NewBitlist(64)},
				&zondpb.Attestation{},
			},
			wantedErr: "bitlist cannot be nil or empty",
		},
		{
			name: "first bitlist is empty",
			atts: attList{
				&zondpb.Attestation{AggregationBits: bitfield.Bitlist{}},
			},
			wantedErr: "bitlist cannot be nil or empty",
		},
		{
			name: "non first bitlist is empty",
			atts: attList{
				&zondpb.Attestation{AggregationBits: bitfield.NewBitlist(64)},
				&zondpb.Attestation{AggregationBits: bitfield.Bitlist{}},
			},
			wantedErr: "bitlist cannot be nil or empty",
		},
		{
			name: "valid bitlists",
			atts: attList{
				&zondpb.Attestation{AggregationBits: bitfield.NewBitlist(64)},
				&zondpb.Attestation{AggregationBits: bitfield.NewBitlist(64)},
				&zondpb.Attestation{AggregationBits: bitfield.NewBitlist(64)},
				&zondpb.Attestation{AggregationBits: bitfield.NewBitlist(64)},
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			err := tt.atts.validate()
			if tt.wantedErr != "" {
				assert.ErrorContains(t, tt.wantedErr, err)
			} else {
				assert.NoError(t, err)
			}
		})
	}
}

func TestAggregateAttestations_rearrangeProcessedAttestations(t *testing.T) {
	tests := []struct {
		name     string
		atts     []*zondpb.Attestation
		keys     []int
		wantAtts []*zondpb.Attestation
	}{
		{
			name: "nil attestations",
		},
		{
			name: "single attestation no processed keys",
			atts: []*zondpb.Attestation{
				{},
			},
			wantAtts: []*zondpb.Attestation{
				{},
			},
		},
		{
			name: "single attestation processed",
			atts: []*zondpb.Attestation{
				{},
			},
			keys: []int{0},
			wantAtts: []*zondpb.Attestation{
				nil,
			},
		},
		{
			name: "multiple processed, last attestation marked",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x02}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				{AggregationBits: bitfield.Bitlist{0x04}},
			},
			keys: []int{1, 4}, // Only attestation at index 1, should be moved, att at 4 is already at the end.
			wantAtts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				{AggregationBits: bitfield.Bitlist{0x02}},
				nil, nil,
			},
		},
		{
			name: "all processed",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x02}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				{AggregationBits: bitfield.Bitlist{0x04}},
			},
			keys: []int{0, 1, 2, 3, 4},
			wantAtts: []*zondpb.Attestation{
				nil, nil, nil, nil, nil,
			},
		},
		{
			name: "operate on slice, single attestation marked",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x02}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				{AggregationBits: bitfield.Bitlist{0x04}},
				// Assuming some attestations have been already marked as nil, during previous rounds:
				nil, nil, nil,
			},
			keys: []int{2},
			wantAtts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x04}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				nil, nil, nil, nil,
			},
		},
		{
			name: "operate on slice, non-last attestation marked",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x02}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				{AggregationBits: bitfield.Bitlist{0x04}},
				{AggregationBits: bitfield.Bitlist{0x05}},
				// Assuming some attestations have been already marked as nil, during previous rounds:
				nil, nil, nil,
			},
			keys: []int{2, 3},
			wantAtts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x05}},
				{AggregationBits: bitfield.Bitlist{0x04}},
				nil, nil, nil, nil, nil,
			},
		},
		{
			name: "operate on slice, last attestation marked",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x02}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				{AggregationBits: bitfield.Bitlist{0x04}},
				// Assuming some attestations have been already marked as nil, during previous rounds:
				nil, nil, nil,
			},
			keys: []int{2, 4},
			wantAtts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				nil, nil, nil, nil, nil,
			},
		},
		{
			name: "many items, many selected, keys unsorted",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
				{AggregationBits: bitfield.Bitlist{0x02}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				{AggregationBits: bitfield.Bitlist{0x04}},
				{AggregationBits: bitfield.Bitlist{0x05}},
				{AggregationBits: bitfield.Bitlist{0x06}},
			},
			keys: []int{4, 1, 2, 5, 6},
			wantAtts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x03}},
				nil, nil, nil, nil, nil,
			},
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			candidates := make([]*bitfield.Bitlist64, len(tt.atts))
			for i := 0; i < len(tt.atts); i++ {
				if tt.atts[i] != nil {
					var err error
					candidates[i], err = tt.atts[i].AggregationBits.ToBitlist64()
					if err != nil {
						t.Error(err)
					}
				}
			}
			rearrangeProcessedAttestations(tt.atts, candidates, tt.keys)
			assert.DeepEqual(t, tt.atts, tt.wantAtts)
		})
	}
}

func TestAggregateAttestations_aggregateAttestations(t *testing.T) {
	sig0, _ := hex.DecodeString("a4096de23667f9a74693456e0d7c3923b0a8a859924cc17b694b25a5b09130552213d0930d19cf93523e922b68e05e5db64501467aa81a69f4bec186534151807a106549ad577dc164371ed8b1a8d64cbed0d12a2f3669dc46106ba54ceaae73036ad67f8e02773edb33fd9e0ea5599fd8211d7deb995ff6320745f9e7f460161de7e7a7f25b6db17d541837c23ca1b8a4a2c215f61fbe4050d03a2c88d8a8fde2a69998bb8622926b46fa5b76299babfdc12b2877b7b18d30d516574552a6a83f0d1b9fe0888b0f8d5d121f05f7f745732df8ef80e3cecfcd4f45420a64a393b0f5d0f5beec5c95057fb6df474c947882e0980ea3f0ed494f654173809b5eebe7e8ec34bd9885c52c319b85b5c645254690c4ab807bff7f21ea01cd79998a6374221e8a2f9c9ec8a05876996f72820aaefeba6b9987bcd8e886df35fd1543d76bb2291593e8de7ceed48e46fcaef9c76396b7facdfeb8c97d19b85d381ebbfd419f7f9a93b4a03a3771aab1d1d07742d6f0e9c0b8ff80e437dc7953b381aa7501bc18f42a4f7576fda725c689a7421325cef139ab3fe3fb99923bddde8b58f8d32ee114df5ef4bfba571894d83d0f9070c74a20e6d6dd32eeba75a0f31260823f45cecd28f9560f7d72b0725d0d54b4d9aab2710dea1a09420f4fa344c50798a003d14ed1c2fe76154d1312e686af0bcc6c02f6352e0433beda843e02c47270a7fe2997fbef0dae955527ccf01d3df43f052b6bf5aea18452f685d3546d1016dcaac71b1914ccbddd475557d0c60b0e0de85822ae1a0a09321123af1ad6992dffe0683ff4beb3005d77e05dedcd33b7b6a700566d13c3e4c8d30f21653c4b31027b2e4a75f6b815d9fe7b5e2e55a761101564d3ce402638898d8b0e6c913adcca7cd60b48bf62ddf845569e76f668e00c804435260285fafd85ec6bf365b65819256197fae8b60385f28170d383e6f837bc7412870da524e281c58a8e21e9ad22faf0877613bc4e2cd4e6cd6eb09cdabd9db4af0dca147d72c43d56568ba879332e8c8ecd7b067e99350f2819e9d4bf9018db0e8deaec267ddf80f1c6ebf51244f7e7b334e90d1af11ba02469658521936f0368c66b6184372401b6a3b43214a9a0e08c4f618f4c96824270e60bc2a201a5efc8f5bda3d88a769a839564fab75d7f12f67d52a32052a31dbab60096f1ec5b67ade1bf1acb4db93dfc79bb62d89ee5991f0a1a2bdab57863007575f672b53d802b0e021d008c7a24dfaaf198abfbbf2e02200157127d0545b57ddbcb44bbecc96069bd4f1c77b232cecdce27bdb483c5f1460fda8a0fc2972d4d85443d8d8b96926cd98477257840aff096b7455e3db818811a8acb30fdb651aa4471656d48dbdef533242abd6d4782fb9b99923ed0d249023166445ca1dddc5bdc9179b3e567a37bd53a7cc93db116b3f869a7066284607caa5f13c91bf650bdde73581d9610ce35ca01be91d02ae38e3ff9b59fd0380e9dbb22a4ed75779a69ba6002021cb6cad385b4fbbbbac1e7139c209fe82c3213ebb67dd035b9bc28e1d970bc74e58389268137b717560ed77a63cac40560a91a138518421b4511319ff05c49639dfed6962480955aec5283366ea13512231babfcf5bc0572e3cc664d53843b8980e11ce6dd43edcaac47f53b5a09df41fa7d45f67e4344c912c0943735116e5697461498321c38274e3cdf48108bfb9ffb7595f2d9797f62ef1ec6183c326740874b5c10276dfe845ce734e4166cbe25d610c7ff106d0ea58df95707b797b6f324ff06e994521f8c1fa8f0c3a196c177d8bb3afff22e3d355beedbe682d4dbbfdd3baf6170634609da868796fa7becc06d2a1c3105fa6140380503e444269655e0d4f7c247007dd9ccb74ee82db257ff044bf758aa053a871433932aef38fb0ed34e1940b2b7ca57e3c2811bbc7f682d7e314b67d03faaea50737ca26d3098074177c818afc14435e515309a08f00c9350d0133f1cf5aded4c486c6f189244353281212f28ba669f2e0719e194604674ab67f5dabc62a61ffa8f4eb08d12c1d7b0e31656d406901347a2832fa2dc941c63b5940fcc31195f4bbc7e8a32fc765c6113fe157bef846b40312bab68c7e94d9248411b667891679451e2cbdb584300846798bedd13ecccf09964f10a0b8a956afd7b1646d6ee34ba9e0cf368756a13460d38f83a429e947b14a54030e530a2907f1f266292e92e0dc1520d8901f97e861241438bd4d387980d37fec60b9ab5cf150527e1497b77abf7c334dce524fd1b8a22e36ca2527639b9886534948143f7894388685de0d205a5b93026e79c5d1e430a12fe1c67eb95259774b8698287b53e512f8acce30a8030387adb9edc14a4e1308c8c75f2086a4f94643a8d737734fbf7214a763c2e549372fd5e2fd4f8fa587a58d870d169fa97f40b83286cb8eeefa12c593d4b1d9f2d3269f8eee3cd2960d2fea37bfe7bf2a2ccd3f0a3be0e8147f9decb9c1a045125d219e0509271e3e3dc8cb2aad2227bb8884f38f042feaab680e67763f4830c398b9a711f4d4ce43c11e0ede82c3567106ac9989fb9111beae74e0f0059c12a308ad66ad677331789e272e84a917062b4335d4abd911d77c1537113477cc2d12fe47c6733a4a5ae254f0705b74d1531c1ef121adc6035c60e49b3bc8275b7de930b957659085ccc290f71888497a6a61fc26566da3a9b66d7997f2b605c2facf321b463f10a33cc913d20a40e86da7ac57899c69458f4a76a6d5c1aa6e99017a08ff37e2652aab5286ecf465b60fb40cde3f921f73015984893c47a6bea4bc7efa9ebd4b9ea310dc2790a5ff7d5dcaa9b5ec730cf9551ed70678d0f4c8d2acac8d1f2ea7304dc90691d0dd98099150d8a318184a4b76dfd0b7cae2569178061bcfbb69a30200901a4fedbcf175490dfcfd267caee2e90d7406c45dfe5419cb5dc4add7bf32361cf3fd1c5770ba09ac290381ae2bb9f520772ab089d7e985af74c16f73ea84f4475eac711e097cafd9596f9bd91d48c31a8c1b13978b795a845aad85f3fe08fbb825f4b81ec0b9d12483a2676050b6c6a51290241a8ee3f13adc57fb36a0e920319dc7eeb252ac71e5c6a771f3990dd83acf38c24be0c6c9df1ffc17084cf0f10670945595787cfc3d19db0a6a14820bda56021b1400959b57ccf0d096ed43b75d7ed0194096343e831040dfe8399393e9eb7704637c33cfb7fe6b62d59d99e59e23c6973944d3e5a2a9c2bef3c6f456783ab283cc75b01b241d3033f9b59441857c626a4be2afad85450a1267c426d39678c81da11bc2968bd6b025d7e128964001b92fc7d2563b7f0d024a6d07b6b7e88cbe86f2ddfd7337346e52947eb582c780d16b397fe06bb980fba933cc7d84baeae379547aa1af28f2576c26c6bd7f1893e4da32312848a038fe4df70e55efa08409bb369d2d80882735f1e8d359c4545af6be3abdf4755570b395aa818b82cff0cfae5b046d439c0e35a9841ea95c9abb1db9caf47c49a1bdd83e954db19af9dd480b8721307edfe28dcf4a4c9824a4cd84b840e19c265735d327d0ec138dd4a4ad5e9ae3c48412210455aab6462524b6e64a191c9c14e9ae6eb4d046bd4c42533bce9d22faa1b2b29c3dafa450d29bf261772bb287e1dd364e1b890593758ba88973a7fa2a6b221a19e277b641a17a36b5b5ca1da9fd45339162e526894d3398cfcf41aac9787000085664012485ba31325d826ea9513036db221730035b8b11771ec990d01dcd58e2803fc609428cd66112a6d4cb1d690586405a1b6a8ba4da16fb01b9407446714928bd9b05856fd6d8a9a403f4b85ee223f8680060fc6b0a8a62c37b69b3d69bc6429d73d930f7f72fee7ebf096b8253cf7bef53f933fc1f1f44197762af3d34d4ee7ec99229f3869a2017c6d5286c6d933c255edf9e9404076751b328d685ae6843ae974589b0e87d66371ca8b31366b0d4890e879b012404eeb6c90f3ab70cbe8999bbdc8c21313b71ea7668130fce7e043140d406926a437e564421c0c58f3562fb8b31d395072dd1c71ee34df7d4626babdbf0e5cdc847ad3e4323e5f8c7b842ebeaa6380c3255558785613414d9d07ed37f1e056213ffe318a4a46423d849c6150f53f3acd5bb7854294b5e08183f89a99be5d9720c44de258d55ef8d67a77b640db3b90ceb27722159839fc3499bf00d6dc69f10396db75ec688df871989f205c0377d669fa11a2bc3f3cb95ab1f03c365e04184ac388eba2684df05e667b7964ecf5370bfa3ad2b15ac2ddfc78a51e8c6ac2a4f77a55bbc99d1984e3df38cd357efd8343a805526a03711bf1bb775e9718c32717e00e7d11aab6a4633d72bd812f30395eb0bbed9094126366b8d95a955989a0c239778c2fb5935e2328a29cf04decafa1bc93b2e4e67864650aa55f7038481e12c10344a8209278a70ab844ac01ea51de2c448660dc99ce4778f6009ca9f44e6acda433a455f88fa60af13cd26a7fc66a17c2bbdbde87b4dad0e44b684d7171cc50063098385c46e92417eac40d2422a567d39f8a4588250ac471accc5b97510ca741966fb258e02600cb2a1e783aa6482680a3d0b43fdd1999121a15340189f00e69066d99fffd267ea0edca3f9ae53f0f05e9c9d6c60f3a717faaf8f1c6699a491fab0e60df8db8a955b93e03c2f2c085ca83d5493e9a2f20006280316ecfa57b0b8006a4f64732647ed6d68052a30edfb3915df1de7d55155db0b5c0a6fe71e10a4fa222cd45204b54847795bb0da968728764884fa40346098f7e03469a99a3313784c928b48bc3ba81aff577fa00e9fd8c532bba6afffad021c69810997742762fb3c82529a93a51317933c6e641d9f7537fddf5227385ee858340f8d43d28052b6ef3138acbbcc4469026788101cec334be3d918064888242aeb4f7fb615f058e4f6d3f89f0481f98e132e85bc8bcc93f5535a72952b2ea175e33eefe532cfffd2b61f3a1a6be9df3810c7d869e25531aeb75b9a9fb09461defd567328acce0800f3b4c21d3fbb1f4cbb099da497089de8f660d39eca113cb1989c3b9969c64e8fb4f276ee0ca28453232df4039c8ea612982612c0da868ec3ee511a0552dd74175959628e6279524a8a926c9ee86e23398fe9cc3d9df94d4a84af3e106c42162955cb19443ca0c93bbf1bcc798d38ebe8180cba74e6cb4baffd6b74e0bf4729f1e55bb837d499cfd11f4eb6718a9a1b71fb5cabb8fb6e26b7dc94c3e8e16b2ca476ee4109eb42c4948cf97d76a0aedf2facd301584825142daa60c4923e65b9ee2b4ad5f326544bf0be470093059b75d7059944e4ef04fd2cb3d22655087f8ea3776832ffa92609bab47765d71990a82fb873f257bb221e2e00692949c8cadedac7520318d3574934ad94f80ffb2debff0dc4c93eed28f6c59498cf3e7b930bff776d55b22f4968ff8b333b32498d77931059f411e65f692095118eb75692f4ab11e9390e7b456e936dad287b7f13a450f385a9c5c150638762253f1288b76fd9f0f0a17ecd6ba09875fc9f8a6998369b0baf2893ddcbb173587800364749677e40bd0fb14eefaad79761ae715069fc303f428155643a07440c62b81b29cb93478b402ea39a28beec860caf7a70c79932de9caa78b8397704e825e69ce6125d2e8f629f0f91e090fa34a8218c25b0c3211f4acbb2779665efc1756f6ae35aa8d1b7ec9aff01c10983349eee319ec901c25fdc6a0c3807ce4257d52464e7fdb05a385f0613c989f323df0370360c682012a7925d4c8b1550380a9ee2ce666d6d4a8cb2a4abd2ede4e7cbe879d52dfc1e455baa4d9a3c9d850faf30ac327bb2d167c0fc088f52f521a8bd71c3810ea4919f43e4ebdb8a075b0c7e17da7eb4c107e6adc2a657a0d21dd083e7f5d33c2b84221a4261dcfe2ce2b6056e2b8024393ab4fd9ff195bb6a80ebfe39cecde287b0b9324bf45199dd410ec936229ce2b1c5a802c2fecc38e87b1c50b579dc14a484ea7c61d80142572b389684d8d6eb7665a14c3b716b8e9b3f386c9347c17eec588603fe330816a34fe80ec9012f5667a2b3f89a0194105ccc39b9656cf95ac4b68a71845a0d0cbeec596dc54cdea4601786fb21fca87882c1b9bb813a3f3d153898dfd042b49dba16aec040acc5eb9c03e401914ddd5077f65f736133da3061ef95581c273c9d68aec2e15a98059b9caab40dcec0172c3dfbecc3c8653102595ec1abfdedb53d4108488d1dff8dab7eb78398d8eb4069bf75dc76b8d340f7c83fa9fd5059bd1929d2bcb74a83a3f1ff0572a116acf8c5e5074061acc652232ab89b90125b3b14b621ebf1a070375fff584b51bc86b6d1ebeaf93a6d44d3c7b60b6509a680054668425cbf1c10e227e95cae4f5184a56a9b8d4e705247987ef144298af070b164eb7d2060c0d212961a9bde4ff10142e303a53568083afb2e84c5f6f7a95c1ced300000000000000000000000000000000070e13171d27333b")
	sig1, _ := hex.DecodeString("4fb8e93303848951069aff9a86f9aab7e025cd533ed60f79d8a3f845614ac525eed49852e30f039aa98cfdd8de1e22822bc452aa3c9a81b94e82624a043852f3021683ecb5087fa87cdb3f044c68748aea71c43e4fc5dc1cc81434d4149293a1cc8cb05c3200affad765122309d49d8db92cd302b2327f992ca367e78be33757b402b1ec9e5cac79643af8be8e2f3509d7c271e53dcb11ced6c7f724e65a16929200af1790f81e85d18d2efe1e33714357290a55ff61f0212422fe0d0d3e4d2c3aac33362f6cd2e4128cccde5558140ce230bd3ecfceacf85037c2364140ae1009c03300ce899228c759c9c950670a57bb079e89985c76506dbc603539c3c7f88de7f6d512ab158c0a319ead04a3fca58fb4ddadfd32f8357a5960d3a7010b0b4424b3a63ccde4a28e9bc2aadf6d0c178779990efe616efecd56915a2ec8f1479eae30ddacbeb9f6bc33db1be8cbccb1c8427fba5445ec394a465d2dc4cbb794070d578c8a57fb06f2311a40c5a35158302b0d90a9d2ff0132659e70336b6053516a59cd31bf24d878fe14bc63bd9abf4e9bc9f3117b68d38147ae3c22de8cde0b2769963da2ae86447358793149b82c4079d99efde1ab2817389ceb020fdbe702925e5a644f8fef1c84888a9b96e6f82ca62ad49bf610a801d477c6a04e307cb3b812d2b47227cd23cea58f6f56058c58ebfe2b66997528e843d18a63d9e08125dd405797f6e10d71cbef277b63575908b0270c7e546542a41cf5fdf593bf84307c03cd36a9edcc0f505fad7a416ac84049cf588d89f8abb55bf1768be63329dcb72a321b1fcb2d2f64eb51068ffbf560d0de029714d416fbfba1c60e29a55f70732f4c2dbc101a15f9256e3272aa3adca2d2b5aba24f7b8771192c598f10550570338cf5679dbcb1dbbc463a6fa55fa3ab29ebc324eae8884f3caf90ec8742bd2931610d2d4306cc064869048e4a819cb6bd4d21349c66fcaeb163283e1f6981d24c74e7eab238723e0aa405a79ddd17f33f23e5b4b1cd575b26569ae9472a6039dccd47f46c9092bb6cbd9efe520248f41224db3355f03152c8de6681c55351e8219d830ed5c6ed1e8f31cd54c8d7d3db3763376c5d3ecdeb77277a5a68e6b821422e72127e4624883f512b8eeed29ea95ec5e0af53aa1aa7bd4f25493dfb5aa985685b027d1fc3abc45628851d186cb9879a59b38470facc7aade7a58409e6e6f5ffd8c44454e17ea4206cf73b1464219fdb34e6d82d2490681955d8d9db898737c0de5677d3f61c54038adc804496bbbab382dbe707ee880499c30cf310332a70e0506942b87de08e2be2bc2431ee5ce0114effc09dd2d599794e56b6d00d2ec3bd215bebaf38ac37415f3c9b172d4a408ae9000fe42d67c3b484ad8b86133a8f9660dbaef37a7f77d50595a21d0f484d718661f3833b91bede18e1a9e75971f96f3aec7a3e5fa9c097c56b1751e0f4bf6e16b46e8dfcedf453cfee58c066c36875fde3b7ec7b700906fb4e69fde3c3157fd9a47a396248ee3f9b3dfe493d878f36ec0194cd5a016fb47a864ae41efdd6177167648c644a08d2d8fbe0acf0d4330fef18718e4f301a71faeaefdfc11ccf1fb3c1eb1c70a5abb4fb2bb4804a6f1dd2e23ec7fcfffcdb010cdd4d5559ce633dbf44255228bdb4a379b4f52a2f20f0b98f1c5860e2194f362f97ce8ebb5e33fd555ab447be7a43557a3a2942910e6ed5b7e8e6fe92da298278a6a8a24a6960860fccc1c86187bdb179c78d04a6b6ff530e3e3b9ac403223de50a178a9eeb15533f0f98d5fcbb6757e7c11659c2a7fcb3f02289cad9ed85bc0024ccf3bdbf5ff2920a366cbac53c01c7487f8d462b45d8a6af632bae27efc39ca16ac7bf9950fe64cf8efaaca1858f3362e1cc0c3c952a03b7a28e196222d44b0c5452d0b217de92cc1d37e1ba8b242399ad4d6c0721f9aa46fa643a80ac50fc5fc5ea5021ec52afe6f9c87046a4a27831e73cfa1e832e2751728c66d220b4d25139f16035ce6003e3ab9fe1c5fcc01461321bafb896d9ecc938534e4305391e515f3ad2eae10e97434008ec141b0b4e6965264b0e1c9d5d70c784234a2f302b9e92dac4e792ca736a993ffafec74a6d6a4c7bd28abe2836d527b3e1b6717651658bf42e57b9484732cfc715180b9063f3994741a344cb7134d7ad195baf1079300e9fa29be0d04c548a707393b5e5f716c15e40bcc4bddc113d45f6d9c6f361ab6ebaa41b9dc096b458ee5d980e301ccbb57cedd5b33434a18e0ada5c87d7de2d71965f470cdae5d6676e2885e3c52af5ddf1fa56c77b43dffbfc600f1baa16a243586e48d67c896922bbde594a6c18243d607dd548fc5573c3ba7cf705f312c2e585474dccb439fd75c29a825ece8c02f1a2c5d00694107b04c211373677ebe5772c79578a585e4fee2f88587134364ca9967769d28577716b20998d41279be110d93afe44da93191f7dc2b4becca0a2caceca280ced77fd81ab72e1a20ecb47b25df7e2a5d8b3b4d27db5a4a4007668d762685e1b7483fca6c6d1ffc07cfd06fb3c94c93d4043a0e79dba9ddfbf7e471d9be50ddf5856bac3d7a9814a14e122215e6cce78485abd45d65f2686c70951eab8c3933e66c0b561de18cc35486294b710d657eefbc74bd1211a55f7ea2b3a50315b38a60a6f30ac7f001589d2835b452cef723849ee072c97201b418d54398a8bc4a62f6d966a29639514a28d0a1def6cc5d0fc1c16ac4070b5296e7d193831a22d2ebe9019b4bc4f29efa1c3223dedebf033605dde7478372866feadcb2a1212833d87e61accd954911df80014cdece32c431cf58a3a58b38503438fb8567f3b59f452ea7c508006fe151314d1df3645b1343651105b6d1167b853eeb92c9515ba5f900df8a7fa7014f22fe7da5317020d8bddbf9f1047ec81554ff0d62020dc6e1a3ca3f0a9af69eb133418ff23511acaa40ee80bb632b55b18f05a84a7c251e00b9dad4d50c3342b01fc43f5d9492c362915ff50d37b726157052ba0eeb8c9070fabd5eebda2a8d8972bf7feb1955cd36edc3a15c6f0c445cbe862abb9841664665dd4a2c95576672d0c84bd2211ee1bda92940f7322e39ff76174a7cfd819ccbd1e59d2fff401eb15c7abf751462d8599c8ab8cd040cab2ff229b2d5d7c37be28e03de62809ee3873c253ade9fac87096a53a5381bb79e1908740fa61c406c840cc7b971289b6dbe1355a49f9d08e913eccf8673ece4792f619455e5f5c2f815c74087f481f542b0cf1060cd66cfd7dedca1daeb18f82df5da9201bf177d2ed0b91267e6d3f70e50c4d5abfd5c1d4ec2aa5a6b161400b8cae948ff77b22eb604cbe59cef7c29c12ec0a7fb6dfa4d0ab7c2616da41bf71eba24772ce077e9957c1a25c2109735eb0f1c5db750cb7b965f109903eca5b992fbb9c3b5db60b51a1de80ef5149253efe5cd82a0ebde5cc98e3a9cadb9fe67982d04cfc420f7871047b292203c2cc9e45d63a934e87b20737be444f6b77d7a07284f2b2f6c1a8fad80f517969751b44afe45b3a0bc924c8a3aedceedc3922347a3378338950cdae95d04f7ba157a6ab7c3003329995c40168a23dce72df720664c8d56fc84ecae6526342dbee3ca45a7d1c36186ee65a8ed5811f47a02dca509c6253f97e1b0f831451519d586658d46c25d0ad80523498ebf126b91898dda59db9b9a3cdca6d7a60247c5c60fe9ef415ca1f8fb314be099c394f872784c435102564b0dfc20c5d6bcae40f16e41f7611e2d26809ede69ebc523a955c5082d9a3abc074d43e715a500db54181050361805c127206eebc293054c0e51aab6615758dc60d2c8d25f8818f63b0e546dad2e0e1331d2ea1a629210a3922e73c723efedc5ef8ba14b43115e29a485eff866652e022ed8cfaa0c45b6e4673f44cbdfe77c386bbf3f6ce5dc5ba780a52fb0f8939105c4071f0ae83200f8b0604c1aa5655fd6e9c63f35576536378433bfe6490bb0265f655815e2942b15cb1aad3c433172dea178b9eea6f0542c7e5c30be39d24bc2e9a76335c759e856c95cc067829a1449a7183eb410ce73a78611fa59c1722b1252ef54db4ca83f1cb3c38dd1b573a3c828d7b7896ed8e6a16cce7722c9486aaeccac0dcba43ad03f1d0c64a71dc5b1e070fd7050ccbd5d1da666be4dbcc4edea95086cb96aefdd4b002293454e9e6e8076f07e38a0679260da8d40e7a1fc5ea14024bd3e8f3bb9b6d6211134db91a6db1cf2027495293b456a02d7b7836aea9029c81606580266c6fc2a97b620d68e2f919a5e1342e75229b38c50eff35a6c2584a1c9db61b34a75603a4afd7bc7edd6a46d1d5e7451c0f2c371e7632b8b77ee4124070d991d541edf721acbda898ce77b8ea778cd39b00604ed3ce63dddbd1871c7cf5ce644ab291d4697a07545e50bcd66ca8a017da6737a0af20f32c80c2a3dd0c2fbb14a63013151cb668fbced47f8c032fa8d4f67745c7e697d7db36d187f597c8da3ffbc5b45430230fcb460cd47d6b20c92050ffe122b5546fd91d467f0f34e183f43c62f65616423bc9e445930be3846831bc9ca21a37f6c426c26da2fb99e415dd2a4966ad4fa4a789fd490ea35ca2781cd4e7bb8e9d57cf26e99b381895da480e6405fb0f8a6594bd8ee111107305dd9be538adb021ecae9772bd2f11e95a52ae9b793ea66a3f98adfa4fe4eb72e933e2ab114517fae6d6c8c41d3a9bc9fb7dfab9e73fa2d91396513c43df88a06e17f0c6d259d45e6e17104a72c2b36bc5785e5ed376c57b9d2e8d17062c8cab7104ae8c07131ed901b776c2cb7415e9358d2e3de6be8ecaa01c5488dab200bb0fdae2ce69939532af092af418089a24393b961252d376648e896974cf7388aedecf31f487b9862a8668c713f01ac0caa40990bf8efc61a36e5bbcfe752b8065cead7f265a6301ae612f51fca64df986333bbba512e578a46fa15a187dce9cff94b41982f3af310d812a335cde7412c70af22896a837403e90533cefe891bb689af18aa0a0dccbce6a74cd692b37d580cc11199027f38c1bee41d47667f567f1adacc4cfaed9bdb4557f7a1a6449ad84af05725176ad1899111583da4fc51bd8008f65f63dedc6b2e336046712ba73ea84d71efdfa8c5605651f5ce57b6833bd8b954572951b6dd64720fa45496af18de99b099692e3f718a89ac71e4ada875686b88169cbca5f5dd0b991f8687c25cba1069139ab785fa30add92e6f78d5215ab476a1a35f388fe9f507981e52e5d534fb147ed5f303d7ed77c22245490a11ca87a6ed507807ded6d22e67152bc4fe7bdef92576e09ab27e217a42372fae23e42602d2e58d0531214c46a24e8f7a55b9878318707eafa1831fd4a631d1d0c5b606b2aa38376199b1526786519806d0a6d3a94a2ffb807e66f48542ed0653220334f21ecf340e022bf630fd34cb2422559ab4cccc25097d8d14065c90fea8329346ac79576c4eca2ab7d17bf78aff8bd8b73d18cc9ea38bbad18826eca1bd413f03155f1045ed5cf4368224025fd845ee6bda030d900ec0e81f821a230bb8367863b926faecbef166b07deb428742bf8dbcfd4662efb642b6749dde78178c70c19ff705a36ac6e87de8cb9fb0159b98c20de4dc15ed0f609de4853947a68505946ffc315086757b05052e1fac90cc96b9bfe35a879e07419397c71c6c7dc31ca4f2ccb513132cd25ae41c112851c336a258097a9e18d23c1880433b97d98414567424612c91d0f8d45fcc31ae8c57057c139e57d821d42b07443b6b2ad7b2a5a30c815af3ede3778682284cfadcbf588c314ac91d519688c96295ce3a40b65d3999d0ee0cf52322634c1598d029679f5cc5103bf7b2bd3f357d2690c597a5d47c0efe1bc8426e674ed589cf0497575c2d921a05650e437e5e96f2c77abb329ad94c4658812a62b31c82783d53ed45bbae827bc7c7d084c5f2598187726177ea11cffdcce1d590ac800660b3d799eb715f893f3ba228d43a71ca6e0428626633a815ba6ec993cbe30f2fc18a1cc31c8308b198174f76efe067ea0563a680549c4123c2e6f3487db5dbcce9c74abcb0c4a2ef160d63a5bff996ca7bc2a8b7f0daf076bed26a5c51e407c259e68661b2699115aa42ded4232e8f4cdf911fdce504792d90e546a4987d1200c4dcaf3643dac186e19c19ca7f0fd75042a4b2755859a33ee7aa59f3550399b39546725ba5bb52b4d8666fe1b97939d0e65e7abb6ae443f55a7a3eda1c8697c2ea50f02de4ad19f6b186c9d8802aa6c1ed736565c0a665dfbce1c215226d745a0488438c84d84f3e65c0695c961a551a615ab0fffc99b15cd81bfcfcca3b28d90ac2e2fefcfcdb131858212f0abe1d68caf14cc1786f4c23486104a5153629399bbc0cbf6323fc10b2ea0a1abb8eff2f6414d63c0c7ebf7feff0408092a50759caabdfcfe091574959fb4ff1e3a6a77b0c6fb5a6c73d900000000000000000000000000000b0e17202b32393d")
	sig2, _ := hex.DecodeString("6f32b6eff0da77c73a10212f71fdd5c0d377e09971f3f2ae346fd8cf0ff3b55cec7176beff143e76c071d1b728d89d28b17739a4e4fc9a82de36568d454873c9b04388940032e0a2e6820f75b63f6ea4c80784346c7761ca9456f8ab87f07666f068018f56b86199243cb451a7a92dee1f616743bd24ac3a9cdec406355057f28947ef80164b9f2dbc77e49900f69a4e9ebe44240fc0483f0d47a9bd1d8c63a0f39fd14fc11422752c5c6b346a60d60ab4f5e17e6335136421ec96ca5a49796e7100a23269da3a53d93d16c2dd4e7f2a59e635d451dadf8d14fd9faa0b76ad7321c692a35cc33c946cb9651725611a50a174315a9d1ac6d5124c01b80e78931d9bcd8834bc6dc1a1177bec8464a4d7c02a0f79ecd430808a8c2a63e0702370c84e35b4989a9c9b0e67e8e970ddf2595885cbbe2b524fd1acbbda1e3a8eb57767e5b44e016efafd3016084117ada1e94e3252cf2045a0b3949300d9497e1a7c66e670756315e4299952b007abba14ef17be81432f447ceaeb7eecd3a0f1b9f5a67ecf147fcadf21e60f958c85b14d71f55b3a237ccad3c2dd41fc5a40c568de134f4f5e31e93582c9eb7cd0f1e4707e3d4676043187202372ee40d830f64828983d90096b5b29dfd600499361f29bd0b6127af36358eeffae24047999ca7c75e4a5d84fdd242e33f591f848d9eab164b992f155f5b2e419e3a7f883e8c529a03cbd6d8e5a444515c85c4f50d5b45a7c284c906c343442ae8490eced743b558a090d4b05b3337fc222405de7965821392505c6fbaa012c8b4e6342ad8f5ce082ad7198836d5aac1437f41b7179b8fe6e818ec81035783f48e5d115040e9d4f61e06f55d5d74c08cc1c193e9dd939a5bc18d407a22a0027f6ef3e0ce173a57bdbc11698ab26840c6ce3d3fa3260cd425fea0307f84aba7be28d4d217122ac3ac2f4a92b28df9caec4dc8c12a0e4cd28c67bcbbea5a2412f71c016d059401fc5eeb7dfb311021b406e7993bf23bbb528f4448405422847ce71d041b8b217e4c366a445d04dccf5c1a2a359bb2883e4a81ddb3c8125c13f7636c65f269aa4926842c8f668be98cdeb71450dd24351f074c13434d8466b12a9b94ec28dc3306534b3d0b6328477a3bbfc5d02aee107a1cc83788eeefc45e8ca17c398ca8fb981e5ea911efdcd9bd17a92a63465d303bcd465676db337781217ae95adba82f7411f098410989cc50f6b05ca63bf5fea6df588deb3a8d47e0be8a10bf4cdefbc755464e773ea5ce7f289066efcbc62e20d0b1ce8ed5b684b471ff17579324e49378b65e808ad6377d36252601ac832338d984e1d32f9965372035d08f3d68ee5cb64339690752f99155893618216ef8fed24c019ac88e07e4851cd6c991db53bbfbf0388a4d24538e806387142a4e6035a9a6bdca96cb4464e16a7434fd7cd3d96eff65743224ce2a9db719ee24999b13643ff7256c9a2c279fd61a47fa1f4ac9723c2880fb961173a071ef8a1aca776d83a44ccaefe750095506ca6da728e8dfb680ba1cab29e6b51452d0085cc523eca9e1b004726adce6654c59d83954108b0fd0a579d676293ba891f9a0f457fc2ee63b2022c0d4c5bc87b1c2f0f05db58f32e9f6fb22994f47a404cc60ccef77255441892097965c3af4b9c4a64b6d4fa6c0a8066c608cabd88b90524b02de8e8d3d5d8f8dec0c77d0057cb74b3673a5bbc69c8ca6c76e5a3ec190a5ff765320600c5e370c7b2ab76b04929fe74de5a42b471b57646cd3d9a2724256c04c1ee801ef2263a617e45d8bf06de8c0ca2aaeda2bb420e17bac8438a90a1800708daa84599b4130cc2e7a549f2dda63a01094e3e305152fb4323b7fe50264a923bebe7de088950517ce3fda0786e2058ec34a73b95a250107f3760318f2147e69521136b8b226f646b44d082943e0c4d6ef55ccf102a4d2ebec1048222daa14adfc0fdba7615cbcd00b935ec848f3db6238099a21bd1c30c39f12aa71e6c25269e15ad021b8711f2501de0dee3d10837cda23cd2d750ac6941f9cabb7207cf69801db914b5701f469b8ecfbcdc02f6fe70790c34d10a9a3a2818c7cf8da048cd570ba45f91d12a1132770dc260dfde5097250da1afa8238b523bd31f480fe4329a6f80f584de9a4ebae29296d4e2ec0b1968cb0fca459b4027654d3b01f6daa09cd3b49c8cb26c4bc7e1a87f087f2e183b802b4fe27658776170b06dca7d544376a9bb5a9ab117f35e07c88ec68a1be83e0fe2df251ae48e1d6cea5c827f4fdc8c354f9b88e9ac774cc3ebecd6e2d971a1eb6c032ec323e183c83c0d4132b5d3ea3537789c7ab584ce40ce7862b4f37de36203eb6aab36de9b5de71841c63943cfbaf49b3a54cc06b107709163724eaebc33985c14f8d433b7409ce72f8b8b76a1f52c47dcbba3ad44ce83bf2f5b5ebb1eef0b1afd430d83ea72bc723938c6fd7ac9a8c3520c8fdb61d560a0107ff518867c9b351dc787675a945e89358b06cb155832143b4a85d3136367082ae3456b2d92edd46ea1df61a9bee49658c5cd1c2d55b00603db9f9b30227a8856f8e9e5e249437dd0065ff6e82f38e1fdd2aef52040cf6f3cc5e476f3ace3404831cef5210210e7978e011e2148b51bddae7f9e23f4b2a34ec83e5c1e241ec08ecc5465dde2cafa6acc883a063852c1a825f376f75069e281e1be1f31e5b04f83400fece0b922c0f160c13183121730ca0d2d0e5480af2a0e45c609c1f9b6b5957970fc0f2f05fd75cd27bd11f0894cab493e33294cea46f1c65d8a781d5e30f42bf8fc6d48fc713d61a889330bcf86b49938c1890497d4fd6bff5d542f640cef368d6c1889ba4a1bc04b49aafbd18bade773204013e4444a9ab04313a6dcf6b4694b410424052259f29f2310931046d29e5fdd5ca716bcfe6dc0397891a6e43a590513d44a72e5e4ce36a3028ba6c95ceed8b5edb43478f379ebe2efa119981570650808b699982a797bd7124a1a7183e3298988891caf550fc11966779ca020c05f77a8f7cae6c00d87f56f900e9a2e79be63a55edd672573b9fdb0a576c1506aabb6f789d583fbe8533ce981e0a07066f87b968a9d08e62ec177ff96249eaac5468248db8dffab8003e101e72a500f75b683cd2eff18bf1f97d7cfdcc55e1dfd0d0cd71ec68b2b93dcda3f245a72039715d34a6102bd426880baa2498f9f3f285bcf69db269bd9f8f7c1f894818331891a6e543c84200b424b832a7a770d593d4fa262f800552eb607e36e4df58890b99665fc1c3802d07afd37cd7cd15d7ea090bcb23ca94ee6bfe19345d48bf04440ec70270007741120a812e456f9a15af48784d3ce6e14fcfa87a1353d01f5068b5a662bdbef3e2ae6a5d9223b1e6023ca79f2edd61b78c6fd88f9eba5789393c88b4b0ca27042c84e9f1b7c1c0a2af4a3c3752b3386162efc5777a88eeef48d06a993923a55e01126cf1560b85608a6901230dfccf22d2b772146e0c50be25decfcb1ba7a74a93af2723531a7a7765bea3645261a3d554fe5ad38c54c757911a2f250fe305fddc74cc544cea42b4d8a63c2509cdbd6355271524c02711651e043b8e6bbfcad799aeae42f8689235b4ec9afea67ab5d1aee54c92f2d4d03726431b40a76c53f8d625a7c19b26671cf2b02675c744f7ec89ae16a96c8984e562bc598cd0cc3b3afe988862ae5a09f22737a2b14ae6604373da17bdf3d5f749129f62f02bf29f2c255f53f8a4264c5075fcdfa4f521a4a319bf9bb5b69ef8e9dd6902d68439ebd807e04962dc2e8b8f35cdd5b6ab8afc8e635828d368b47f0b2ab2b04ebb948fdeee2419f02ac15e570dfaa37839158e3ea9add2206d3c96e55702063bcd4301e61c6c7f994463cc805465e13b89fa296ac720298fe1da1557bf4daa15918bde6e7cc2f82c532130122a6d23cd149d962721a76b900713fa98b609c53635cf99b0336e544968fb608f3e7bfd0518678e664ecdfb68b12c64533f28d23a833302396870d3ba74e6932b78c59ce266a812646f44d1f6303e514bd9fd55c2b6d7c42529e1cd9772e8e91621954f6da9a3f9122be72a097396af05ed833b2f1382ca75a6b1e762442c428b579be6349c9995f5c6bd6c5964c69cd89a75b5a4bd7330950cebc0186d5928388873364ca26e5800fc13804bdbd352f8b6342ac106a1d77595a183392388d3e86fdbe53f77b1fb623b016e6b9e410c398ad4aa61c6f473767708483e883d7ec03cf6e8a6b975e9924c421db0f8708517e7957ebd6603c3bcd6d17fb750515f0cc96bd4d30b18df0c04222b2e5f485785bc5023a854f78243b74b12d03299cb3fc673205dad49e18a4e250a33dc74e28487813d9f1b2a20beb9355ec903748b9a9331e93c34796854584c6f9197fb71bd55241ff4247a9dcd53129411ef10acd819c02f7ac3005d03dc9ec24fe6dd6daa191113d4e031afc005087bc702848eb08803fbefc4698b686293811d7df23a838e847cd44c0532aa96b2dd86a28f28c3b44cbc52e879042e9f33ef34fcd11a2494928046c41fae252941c554a8048b5d71a1a66d67675227d89a644d51b41e60876490b31e9ecc60febacfee19605e3eb394be5e6ae00437efd7ea5f2b7dac22d594564bd8ec2c2a52f1de05195026c513cfa7259f82dfd720c0cf78aacc7e5cc1cfe94a55bb1d683d40d961eeb202f8ccfc01bad20ac0d824975f90c18a94a493fbe86731426bb04d33e233d8282b1ca694fa3a9f85f1d148e496fad0b728e6320c195e70c5aa73ab8a215a67eb905b63693dc9eebed7bb7b0953f5c24e1a696a9a52a28a42843d7e2932e95342b497c2e84ddb2692c0c82cb33f9cb9fbc71a7f2887ef038ba89bcc136c2ce84dfd0dfccf69bf6d53afe6ac0f40ee94a8023ce9a21212769e8444634cafbd761f9551f5cc270ebed23c006c3167ffc33f7d9aa5ded1123903269de8144ff17c6750424e38367f1725785f27078afd596ff09bbfcd15bba8e25f7716c58e4a3a64391e2ee4330b6c57938c03ad717aad55b175421278ad731e9f419a5722a57138c285c002f7025bfbf6eb19d8672f52a2bc51ea4f33ef985515df47dca314aa78b1702118b95e3fdfb66e2a57f7f681ff5b4b50e1f77e393f963c55cf9902c22023a1db2e0c5d143561c14599001d0149cc3936f96c1ff2ae833538235e7b681fdf6f32a78e87ed0a2474e188b30d6df9638f94ab1469ecf8aca41785b38e972ca17ada24ab39b41d27ee1ed5cf3e5d640120d2c4e54cb949d8d66b53badfcfac4e7e0a4f45eb2e55870ab8ea62c7b61fd733869bb5cd108caad4c067515413a57640c00bc833896f800711f44466684265976ecbc31ad752e14509ffbfceb9f6659643e151eb67ba9f0c0959718a8214f63df1c15917ad04171c3949f5fd40e2dcd50dc905a6f0e24bdba9a20da2cf070d8c1368242b8d6adb022510af43e6e9353144900b6f2437fdf2273fea35033fe474b7c49542ab97802cf7ac5764002a2c70394c40c5ce42d1a25f8ea4cef9cad8dd572b3e70a057992368e77eeddfba8de6dbfbb6dd9f7f4a1ea40de09bd05dbc30f796dd4c8e5c6c35fe5afc1862cef313672b8d72c6b227d8613906c38bdf70af0fea76cb0532d090c54c8bc0f4f7385f71bbc3f40fa43b8f2cbf49e71517fd3a9c32f51a9fc4ae2626f97c5ebb57d4d9d138d9052bc9adcb79343038ebdef0ab452f81cff3324e9f6ace2fe13fd16a296db6e79141d4d6723a81222bc65df28d0ff3798508cbdb033b29e9cb500cb7c6f673465b5f7fe6df6c45ab67831ebc07b8244fad20ef58f8682e449360359c4c1e8a86281ba4353468e2e3c095dbf85bbba5334edee6786fea19997a127bebb7046022e55d3a93f1bd0f1c5aa314989acd59f7e9e52c0eacd9f6dc84a3b31bbf82de7fe0625ddeb04e40a753964c46522909ea127b5893c1b91269ff7a29ce5339c61a81937b9a21c9a031a4e00dbc7206a0e4afd490d5a4db4d3a3d15f3c9dee418cdbd67ccdb52ee7d08ce6ad8dc7b49e881d16123f285b401c477585eb512d9834a84b28cc60bbe459a473c4571f5831dbf83e806cbaf5434c63277ed6fe3aacbe19c5a0e3ec904698f19073422dd046155f5ddb4ba31288c57ba8d6c23098fc9de5c0f7d6b14e54ae54b670f14989c53c3f9777456375753235fe07c3110229b7e9ae42c46db11c5e19d153ffba628b2aa21a4d89a0866f39e68f499186b306b2018dd432f104deb262ccb86d4d7c6951d1675a763f8487e6713b29c882a364a360a3d950eceedb8fa9228432a8aca7c2bedef45d2a5c121543b3cc1c76fb586ab0d7d2ae6b78c488487cd37114b37b63be95703f08343a357eb2e54dc01ee5209f09147e45ad6bf847131c2a2c618e9296da4d7d88a2cc1c1d686dc70222487fcae12f3f546b738b9fb6bb142a434958646a7984444b6592af04090b5a76cbe70000000000000000000000000000000000000000090e1319222b3037")
	sig3, _ := hex.DecodeString("70f5c97e60dd71005c77a93ba72a0b063d7c1663c08d5467286099c56dd720a08f317595620f794a0c444ac8ea90a1e8772caf3590293c1c890cca010d8e06fe57c33ce1d307449a7183a070ca1f658f811b28d95ac1888ae4ba3fa1cefe64845c0867720e0df5769733e7b195790a6ca6a00ce5d8b142a10a0f0ea35611140f44441d4735fe64c0d0416e5b22e77eec7ef0330c769215d75c7f6b0fa6c069512f720cd588171a9c52db8cdee65bee1a1fdd1b89cd92772a657f0036479f0c2d25d4ca1907ef9ec5b92e1fc6224054fb205ed67f0bd537cde5d338864d4d76b35eeb110ffc371946fff50469bb349e20fd6924af54b7cc871c6051373d691f7b8681d816eef22242cd8e46db30f611960b52490d290d41cc1cc34a16fd92ad0a4287b3121ff8c38052b6ab3ac682b7af44bcd6d66e666eb4c37c72b124bf193332ea022e45b176d956d69d86ae89c2ce4e2ae4f0590d8404497c6ec854d53fe8cbb2ed5ed153ef03ce35594965e6221cb91caacb13cce209c65e66f1c6b5a857947d9f66c21a3457b806f699b34b0e7c0efc09a6f620340db0e8f2a00defb09758b88802c0610e1214bba8621404931b5d617eea354fb53af810cd35963344da8427adc73f20563c0235d04b4b25a602dfaf4edae45510725e9d4504e58c3e58e7094723e97f65e4dfa61e6db0e7d1e2f72cff69376ae2574dbf91239ec2d60f7d89966ee610a22233bb84e2648b4eb3f7d14416cb428871dc6a003d5eaa51a7df5ebac9e42b7368fb9bb78854aca846e933305012613426cd9a617de1e891609bf4a37b612155fa05815c6a3e92c888789372859a4b21b6307da7d15061f322416084c36719be7bd80f730887f284180765d640042c5c05d582cf2db4291c5eb5672d647a59cdda52241094a89ddee1ad4214d6657b69ff8dfb5e48b3256fb6332ff39a975b0526fe15cf58f2b7de6ed997b2933c1dc279bbe1a118091231fdf92713250d7134420f33ded0b4943dc3320a1b4370e25658f52cf875f5a008c964740745cb4d5eb2c41d55b9736a804fa0ecaf7048093ea05775a5e96b42e67c7f03395b1ad5bdf520ad34e21b9f6c575f1922882f530edc248826c3dab2d4140f3218fbd22370b4f76da242344330c019f86346482256fd1bf52b50f03f8da97f8b90b4de02b3e32b257d6e68d3f4d39adba55e058370c2c97200ee07f1850421656c1080522889e9d5f9beab3330fab2e72d4b9f10fa858c01e354b727f8653a70f76588c767427c51125a7bd1504e9a02163819cff949c7699ea2cfe112a9b3be4c752d4a9ebef746ddc56368753ece359593ba11c254fe576165a8d5332593d28959b0203d89b3b3a74afd00c278adc2e8ce496d886432dd250d1fc9c26bad336dcbc8a02682ae4c2441e2b91753a59f63a2c9f7d64308411b35fd1e1f76e441994aef6e4f64676a14625cca4fcf8b9209fa58fc96f16453155b5c696b881526066b8f5d9bd4b5d9cddfb5b307337a9cf46f06a09b37a1e64fe3c85a7656c3656db4d133c109c21203bc0ca55c3bfa047b5d533fc776dc304a80ed6e9e92df601ad120ee5bc55ab2a1b81f33b1e519d0b170eb634cbe694f7ac003bc0cc4d23619fa34e60d5b771fa883fadc618fcc3fb344703c991eb610ca90c7941fc5aef7b713c257ff905e930c3f4263ddbe7e8e60515832f4c388c070ac6732c39840fc217f330ea214fbaa49999d95f1a3cb1c136c07e5cad77b0ff4607ae52c1fbb2202678bd2d3a103c0017091beaf2876476e877569a946ebf9ed8018a9707b4a5e38d11b5ef98637bdc4e79817164f6029dc56fb254b6a051bc63e79fe35151c1908e33c363d02a1a3fd1eeba9f4cb69e91eae080c80f83714804f28db4ac3e273e94b1f01c17d3d002be581fb646e42bf7a1aa394f8671ea93460a7481546469c4723657f4335af31959ba35567039ddeef7c82c9ad5515d654d2455df1ce6b680c525d9b3cab26a37c03a75d77c74aafac1235efe403761c7d554a5341540da348f5673b9a71ecd134b52d6bdc9cd8c6a58b8ebc8a32647adb696361cbfda128b06a2e37b1a18d48732b86d927117daff3b2981267d8314c475e3f9d62b571a7c4457d853968b399c9dc096efa8a28b8d1e5d7ae1b39f63b0d0a10eb76a952fd9018a3333f59e423c44848a787e7749530fc85e77b72eb7fc5c05408b06dad3d7c9d9782fa5e4c4179f0bbd405612e1521653ad12146381e074dceaf4776054061648b5d44f129cf615540ff77d3b5027959818510e29de4dcbe39fbfdfcb8622024592de3113ec4e3e52a4cafbcb68bfd21cb5c71f2b358c02c6f86d76e87d0cf13681f525c8c284cc2dd5b682d523e3942cec3254d73fb9a3177d0df574430dd36d474d53c88b5d917871382207994011d59cc0a356cfa9432aebfba6ca47aad2b7b65b1d6ccabc6756001d89c90d458a251aa36cd97a9717dae3556c40b36121248f33dbdedf6cc16c322713bc6fa946738b976deec0d03421bce3792f3d3ab3061aa6ea99a5fa8fbbdd1d6c50704dfdb9ed76f291da98de4b988bbecf5df3b2b7f88e7c8e43f58d09316e6dc6ca94ab8ad8e9e164e176139fc0b3fadefac87bec179746a1c629cc5951c4328fbbd57ddd6376f1785c81e0f2b3264a8550cc54ee61058a79960e7b535af6cfe1a7c2d657fc14a98a629680b6a055c0d72c899f189951776f122cff7d36df6867bb24b3270cc54a82f88b9a335233d51bdf6ab89f9dd262d0ae2495170b03ce02c582cc925f7cdbceb103b25d4556350db058a62283af4d75bba6fdae2b16e1869b36aa269cfc8a32c7b9d71f1c5036395de140f871ee4162619a7cd036e7ce1bcba27d5501a0c594403fcb4b78980a8a55b92594b8960d1342fe0232d1f082b7d511df886a181ecc4fc03a515681dbcb5823aa769a704137ce78a59830114b0e6eef2224939fe298f2c589d3b1b8ee95dc6add860f65921370dc43d1def983d57f6d8d2a16ec7196e5217df7298e906a3a729529655182ff96e6b93aa2fa7726080dba4810bbcef003cf64385a057f7129448dc1a129ecc480f14681dd295011aeebe0a167806d6ec76760e3c36c5afcdff3bccfd949088bfb804225f0dc34760ef9975075dffa1a4cb6d3c9d269c2a74ae0397b35f0dd7d7850230128cfabecf9c2d5ba32bd43991a65006aa1ee0cdf4953f0085479c22bfe77bdb5365bc150fc932ed45201463e231683c2737198548c6749aa015439aade1936b909409ee1de476c45aa6d73fb17d843ccedf6b5aa9e3bb339fa2394250eb651856f47a161e3f288289c040604d7d269cd13070ca7e23cbaa0492fbdc77c4522617e477aa39d5493d3f0e50adc14e7ab7b3d35c048381c54e839a5e1b2441d53026d480ab9dfe32e1a0a2ce6d30ff6a7d53a07bd9c99728837cf397e9aa20e54cc3b338d37c87ca0dbfc3e39ddc25cb5c47602dbf3adfa5cab67799e1a5e73712c02752e49479c37c581065546e72694a8c2b152f7dfc4c07b0af2588f631f34b68aaf5924fb9e1c8bef32e3e508c17b2ac57ab4a33ed125a4c2d93929bdc9452db3438225918d0fa8f6b5d74a2e14f80201dfb1f528e5f54a319158d81937076ab8ff9d9a1705b6d6a3eb3425f4395d490f2f9dfba4bdbaf3b1ee1f8e1f2f092dd1605f73d5ab70a1f2adbb44728a2176ef4771d379e44f07d048cfa396f195dbfe1531ac4268a3970caec26c0ef7387bbc96b8eedd0b3c7ea5b1f8c4e6b4169878ea8873f77768f480b044fa5d2597d9438a30d1704368e53233cb60551f5c69a89f9f713a87d49324194741dda88f23f1348b7c10e4879465035e420d56acd4ddb4adfcc04eaa2544080a76afe3c677000487bf26845e400f246018d5949223a51435f766df4666fbfd3fe09fd69b9078149abdc20dbe15156760197d8c94b4f32b95f31539679500f5be4539cd5141abb7169bd92edea632d74c9b26917a59e6b66c5f32b9cc3c88a703c7213813b43ee98b2bb7302f2f9f15d1dc27cf770eca4b122ebe5e3620696066838cf8eaa8e087f664f891f7225150db520609ae6110139052451ad6292b5e8fd1675d01a10497456999408d8cb57f8e59d8cb2985b9f68960592356ef50d3188fed4faac46d85c232cffddada2d560b55b8f3ccc206014fcadf31bdcc527851e41903316fb2ffe7d836bc16f779b8d5f3bffeaa4e15954027c3cd126c124ef8cbc9f726e3dcb9c276b4e6ceba59a645f99463737f1a3d31202e5c856ccab972528cfb53920d86f79335f2800c3d418c9b02a2ffe35bf78281e99f1007a3c4ac30fd7a7fccb005deb6aafd55f694b65ae56200c8a2699e1ca39b07dc8dd3a4adfb2fd32d68d9aaf9fd23bb8cedebea7a0e737dbc96714ce15f7ac414446fe34b41715aa3378ed3f6cc6b69411100fd6d4bf6c82f359e807df7ea34d1302590c2693535360eaefe2e02d0ab71d84241beaceaf328c9d427091c6b44ab7381614aaf793c92093f5b90141dee1a1114685ff5ecb4ff760974d9bb2d3e38194c54b10cbfd63aaeba4379d969eea5d3d965a4117e8ade0c35494edf14d74472ee38f43fb74456f9a42469b1daa0c01703bdd81d47f78e0dc49aec3f400d9c6a218c815075717d78689c74d486c62ec19897b7a50b9510fe7ecabddef16d47caba8a9df349345eb6ecdff9524b554eaef56ddb70648ac6b4d2f77a0c02b603a97227afb9de23d4424ef004cf99e0ed976a9d2c6b4a2ad659d354cc55c6ccea97828dc0dbeec03b3bf11d9c471e08082247eff58d20ca37d3e80e5d9783654a40cc07d02d925671e7c18c4cdc4244e1c5223d8dbde289a1b8639f409d52ca165f13fbae010ea2851f7bef8fcb18b53228367ac9bc8b087c058df40009a688c17f6f4f0a46f0158d4c349860faa6e134379e67157746bc5606a6137b601d4de80320348df235d2470a8a02ffff8de5e6e05a5fb90bb766f2164a4badef32ff6f9444be715201393c0b1273b6eb8b368bcfebc6dd8d4a0203f6a81dc7272d570287fc057a6b11d4185bad3ab5380161eafc8d3cbe12ff8d9d7d277cbd0eed319e10c39588d27929680dc00a5cf12cb54167d3a5ea5665a137dc0543d6600e79bfc1010a7104a8da958f362420e5a976a7ba478516df8555ca4fd6fdeab1ccd82ef78f794f36a192a088cec28abd8d1f7c24cb1a79e342e2d453d6eaf5c21465a4b820975d75aed09e3dc6016ea91d8a31a695755853ccc6d9c918f259ce0ca480283e63544e20cf4bd8f8078820fb8442666acde51844567d2a8c60bfe57ee277d6195b5b3a2df0a5baf70ff4c14683bd479455755ad1f1f59fef60a6333bd260ce04035c2088df4c25116172eed863a16136a8b1684c5f1f851ded0487c8409a471a7c5c221187caaf29455d0fa124094bb7092ae8c404faab81e15adcda87d8653d4ebeb5bc281bbb03fbd43ef637ef5e3a9b9b56936a2d46ca1a341cd1427e85e02f6bfbce3060980b12b90693953a2797b59f16300e91e24d39eccc1e6a5004b49d24984a3b4b6fc9c21a43199adda20e82d5442e8dabdce355c4603549afae1a12d5e907fc9c5415a814990f04284c03d9944a3ea26017152cc09466da83fe65153c0fab9c1d7729336ea10d31ade31123ef1ede1a27e02bac43718c453c9d6c940e8ae667cc04cd9151bc972a4b49214f70e8ebf688fe8c893c219e0729a8dd5d98e333354cdfc86c9997bfea9c08b83af3482071bbb49e3d626473561e2618fb38000ff1ebeaea5c2122dd2d8de9967114e953fce399c2fe1e9a036cf4361cc9ca4668a180b97bbecfb91af76c848db9623dc9d52e07430959e0818c86bfb1b27e850acbcae80dca4c29beef6f874f1fabe4a63855cd68e9aada49206fb77e94e69be67930e4ffa67a92e67ba34b4e02d005bc7c65fb451e1b9943cac49d4b0ddb54da2fdc8eec608fac679a5db834bac20845f3ec064433f8ac3b40a6adab46ff0ca8702e63ce6411c73a3a67908bc0d11293df1bc9c35c43615b95daa187b51d039bed34c351894fefa0b25de7a1406ffdbd5a46d4773201a924827d13e2b6d8a0bdd77dcb695bb1994da45ae763d634c60db5d1087ef4b25f95752d3fda1a4a3c0cc94d251e1e68e02cab3df6112922d21087a96786b614208abcd18717868c259b2ecc4b190014d3268d5f0c7914f69cb1b9555383830bc7500b9995b04dc20ba99e0c362eadd447f4d65a40f123d0a14d061707a63bac3ca5d0ee49f96280b1efd77f06d333cecc40d70737d678309ac5a8931694bd9a3d84a42ec25eb984baeb4e71ac3b4fb4c713d05266c4b53680cf033dff06f749c095f1e5e6d863d75077bd5f13a86dea80817454b75b2c5e023a9f907131655a6a9b2c0c6daf1f31a202f49515894a0dcf311185c5d74d640888f256776dd0a0b0e29378caab7000000000000000000000000000000000000000000080b1721272a2e36")
	sig4, _ := hex.DecodeString("f353d7c0ed8a3ed8ce4602993701c7848edd9e22c7f43110782c27ffa035678c6d86994192ef75e859c788692db2ea249fcb71783ccee23b3da1b44b74fb14fbb9daa8c8bdf9638716a760f48aa5af10c9de6b0c2b9521dfedc78f28d8a0b7a16a93c4a74658d4df0a95cdcb0c43f3061ba6d71169f503cff90da824ad39ef02727b5691b91b11eb8b8c959a51665c16ec0150a4017260d85a20a38d39013f132412c9b02a5efbf7eb59572b2b8aba7d982469d0947b37da502289960b93162318243b1a7460acddbadd3850768c5852a8b9d062fff7528dd502e2e23adda751bd48c5b876a9cd95292e57d11eb5bb38eee0efa67b60321f91c97391da2ef37bd79d645184e0fe0c6afdc3ec62849242ef8b6124ab1c7b6e179b2f9172ce1ac3b8e7d2e0a39157a2d5e55dbb04d6c4fa740b39fb84db38dbc587e2c3c100bb34685a3556edf5fbc619126f5947439183853ecb66628f31faca0d365c6861e5243c1e42dca79757b1715f16185552875adafdb09a923ff386a4aa9036b37f584a981599c8a115f1c503c27b2dcd55231573b4d332bea9d3245b2d30ae02b59e7182f9a3c6b81c3fd5a21b171671cb18b48d6951ee03a0b2a68417be34ec1d3b3b2a2ae024cc897882679a90b86ff617a6e325aa2ae1d130fbac83d041ad5bb192c776e8c29dcc377fde2719e9db9f5f00c98fef669d6bf1a5b2a3a1ae0a9d4e413a3854957dd918476d7448e969114aa43765d63a1c5e189cd861f81a38de69371d3c3fe6d044dbd7508c4811cefb48e74a9197ef2cf065ec7fccb44a8edcd5c932ccb346d6fec620a39c97c5dedfb123a0cb30fe27f24b7ef8d06333a53709494b79e2e2aeb0aca9df759f7e87e58f4b25151b6d05ac13025c384c430e3e1b204f8bbed2b2b1eeba5dda4b92c07e7736bda08e39a204bc9178cfef0f558a1d6f5939d33c10b2c26e8654d35c5a49d7726dc8292a103a9709049b0a0b56afa3efb2a93159b9ddc3a95e6b6a0154461a52129a30fad2170a51f72542c99913f0ccb51bd8e757ace90b782b27f40bf599e776e02f9ef6e1585fa9a98077745d6656e04930901156fadb3609f2bdd7c71c556290fcc48f723ceed02c5f379b558c19e80aaed9158c78dbe6e78ad84d9bf4d2889309a04d707cc963b1e4f72ba44f67573487686492a648f6046a1d4d03046659f66d726e389f52ecb401589bb4ae404977cf42f34b6616a2d76c697ef593a742978c1bbabd6144b0810444c63ad8d3135fe373a4a369c22a3163d89ae6b8fa8f92e6ea608a36523eb43c174076155885337218681057b8642b961bb69c7f1f43501fe42ae4b8b94d052e55c2176e4b052e908268ff5a2a019b6eb579369d3134d10fa056bf5ac4b9288a5451221d1a461d3f686671370ac0ba8e1e92c2efa48c53c1788a2feee05cb2df6b5a6de7c6ffe2c2343b0615d8e47305315b80e0cbb36f6776c309e346bab2c06da18a51c794a7901057ce2a5b33cea9e43fcb0d7cf35f27e8200831143d115384974c3aa12489eb74c4f509ec1eef9ce5efd923b3286304f7715f090507ff6e9e2044dcdfc1494a4d763f229440034cc029bba78b7788a090c127df98ba8a724b018c185ed8fd54fd2dd1a3175b1261af021471cda3fa0a2adf39843f4cbd5500a359471386778971259df3f66e20c8f4fef37197c88ddb75814be76717bbb41de8c6e5e6730060a5ce4e4ceaa242ba66dcda496ad1d4de8ff5d89c376abd2b95025275f1fa79ece030f9ec2e542fe125a3223bc1106fe060ce7dfa678dfb6912989edaff6c15defb8c9360024ec7eb387707ee97a11130435afa805bc18bb3e5664667201d80461ab2b395437eb9908434809f33b10a05a1ed33bb14b0e8fb54176f45a1f4b100abdb85d947db5db979336de31847a09a461c2f6f275a15181e8f41f8cb0a8623167b917bf9f44d95122f968c9d97bfcc43e2ce71f7cda9c67bf8e4ddbae930a2f62a79d9a95b21d550ae3d309df11c658c74fd482ed8f60c0f5860b84f758d70595cff280c6438804faab8a7cf14ee75188a2efe2dcc7845feba410c1bf8966b1addbfbd5ac16b4367ef0cc0beb69954b8ab25d59c8d34ef5edc160f56e2b45dd26c127c912bf7d230c5b9422a5082457a47855450eb85f3e0e03df07aa7aeac97732d0486a90f9baead1d9bf9d6e58491957beee7b5bcd759b774fdb7dd6c7afab367c654732b015262a21a5c74dd68a06fe839c7c289e9b82af3eb03a28ee7191fff63e7e1c9720cbd68d9e7259a11cff878fe6dce9b82a21169a493051f28f5025beff9b783699fca05193dac1f00fd39f3ee20b3961d445010110cdd7ba73c746f2cbc55900fe10c40ef5d4d74d6f7f196b8bcbf59defa8b1ccb8a51216c236c8933676cea29f25525f32d5741c46d1536ff64d1c553c8065c1e98dcd145d7f9562e823815f2aa71d3c4da446d99c7dad166e835404a7fd01e407242dd5f201a31eddd3fceb9f7388b9297b8a1d55d12d82268985aff8963f014025fc1fa23b21fe5e1816887a1390f9b0a570a0525c089c60c36f33e139aa8d828c26baa851ba0538e7bccdf0518eb6f08828aaa5af2359685ac05ab87c22d2af8633546fe88e14a509c89c208dd93cc5d0bd618891a6448e1beadc59e51fa7efc99ec401d91c7c22a73002387522ddfeb1c87cc82a9eb4f3f512fd79f3176b8efbfa89abeb2290d88508dd98aca5ad460a542015e650a6079c1c487c43093edb226be678e17bf1eb56021313a1cd407ed57bdd201edb8f9adb6aad8e30a95a8db8e4bd10c7e21d0164d993f8a0c0063f324c8df6dbc9e3fc90a6256d0a22f5b9184108ae313a32791dfe0c8693364cbd9a36aa41b1da752c28c344b1718c93931b17a18c2d9b74787b844ad110ce945a5ddba66a9b7f1271278019b5f01e928f8fd974c1f91a4b873ea83d7b4930484e8f1dbbc90e16ad36ed76ca560b18077031e3a6c6cd4202c163885d1aadd186991a669f6b699c7bbf23a55e71c5f596655fd9b1705bd51215346aac547d6c2988c6fa4a7bfc8e4704ec3d1ed80b88bc56cf87bba15b9ddb952d507856538682585f1c8363015bc4ab625a6b75faf3b57e0fdbb1f2662ecc603a6a6dd1d117ea5a7e7dc90cead522752a66e53315a6c4e5514692c0dda6e93806cf369f9345ae5b2a4150495a5a4d79b92a776cdbf7736b29613bb7f96fe77f6a8e93399ab891c22cd7e60c5d6f5399f9b95c33abb81517832805f866ae16db73f6cfc4b18d24789f89775dc22c0c15917cabc75176d5da7d96d51ffd4c04c0e450e998cda31fba28dbd35e037e6e3f8943724300d1bc61440a22a096d9f669419745bb1f91678deed3d2d7adbc51d4bf53ce4728afaa868029e07db5507a7d864377b70ad8b909af0375a7bf98d15a008d731ebaf9914402161c274c70efa4e74403bccd28e19fe866f79b4cd176b3919a7d6c385c688a3fa1bdf84bb4e2b97c7dc55d90ce221a8660bdd0418b33f131c1ff2de447e4781b542c0db782962c1e7dfe1d68832f5328b4b8e8e98f648ac6e5adcf2512cdb695a4ab46c372ae092f9daf58afd626a914fb6ee88f4a349c97356ca2001d80dbe7b9b2233aff31c73ac05b3ad296bb1aac79f47a6202a1acb7c5f6b66e50c1aab3e52d92a032fe6586a5b8cb394bad0bdeeea307b86cd7868a3051c93764db10c266bf013ff0c54fe819afdb06e6e9f6d9e76923d916c10db8e0c4b28da2620a61b985ca5e52b305fcb3854d11041225e4e8efe2d7ec0c5f3047afe40a314a79bdf2629b014a66185e7833e4c46c59f004ae8b0d7737c9efe37904604b7a64f5eb0c86b3f7f3bec10193b7ea4b405f0bd67fdd272d4921d0b81c2cc459414adae1138fdb817a538cf9b53cecf504b6bf4eca66d967f0e652667e382ea3127839b5d1360e683d483116b5de751e89a2189baae470b751354541a3a2d2e883a22e64172a75d70bd85e9866f84737922af4f0175401ec26978256977c8c320477d7ae84573c371a0adc6d8694fa3a5500b71fb93a7f6f8b491bd7faa4c276e523d02dd8a32ab9ad22727555e9c437287898ef72861c99be5665f80fd9e5cac2f2be40dcbea07390f33edda0b0c536e730d29f0a8a0637e173135b3c3f4262f57767cf5ef791e1d32ee555b19343c0e784d9a233dc7b77db46def80d43e22ffacc7c7048c8d0452471fbd21e6d2113649be0deaafedfae9a2ee4111553d25975191aaad281e6eedf7e4cf9e71f898bd44db8aa80afa805b7a7eb93e3b6f366fc896451adcb57feb765e1e43ccca3a32acbb74fe7885cb2309b0820357dd152001aa8c34e95a9887564479e270f70a8edeff75f06ced772ae36af3abfc16d3d204f0e62aedc615d97e9d1715ebf93fe89172b834e89a750d20e98c066128280bc4b2ebb7656bff1f53cfe071b6744d00a9f69aaedf38d443a076fb102ff5c72a33bf290207f756f634a875bf3aaec7145b0bffad235e2ca47c769a5e153fb6269c70278a30b6bba16c8767a7e57b8673fba1a50fd7b86ed053f3010b80d5ef79311e026d1030933d8d1719513558bc88159e2b30c8e6bb69a652b3cf6ff00efcd5a4d0a34ccc6814dbe5ac78052944796406e794a53f253447bc67b77a5afe49d5f59374ae6ef7cf2d0f6ec076c396088b6a9c02c6313caca430b2f7a355ce516eb1988c32a5f7ec5283cf790b95acb934d0d15502d832b2f94392eab820bd11496505cdb9eabf6a5fcd5821074d6073139803d754ad3ee5ec0746af22756a95019012ddf345560f320c394126bc5d05aa3eac9575b724645e65b6aba8aa04d04e43968c9199176ecf5ea9efa1580e82d70b43f8fafa1af23677eef169e6c6363fd20c02af5371ba4993e65ef4a87d264f748a5af8f5b24844746c8f45d976ed000a06d720cb1f3b5e9de12038812b48f2bc5988aa2ec99018e733791cc2bee96403363da8eb3b38ec5d856fc9d365b117ad6898d479f9fa2568204e9e5743371eac0e0f0760f164727e6bf241a7a3d507b029229e2a1208a981c8a09fd22b9839779e761a0864fc8c8db4aecb43778a566ce20b355fca869703abdd683698d81f84755ec4b4e26ad871126f9675789fdf64c698243feec664841b256e22f908aa13929ac18599d71c623d48c1e83f61d4f2470a437aa6e17315d020699d39a31eba36d15d03ba31e4064e7a6430b72d2666417a463297edac44e8b1ffcfd117b31a7e50ce5bfb82b4bdf8eff4d3c1332947bdc54e638b1b23328d381c01059907ca8da7b7a4955e04ebd1bd38490461de714e212b12b80754d1169d37ff76e9b4fc79b17ef82753e97a5607fe18ce2bf7c192ba283d77b36e152daff39c876b264cc606d832ca36a1b8d7b7cd1beecc36bf15a9a4f615b90af1810dd4ffcc31d7d8ec33e4f2070385c33909322329e58bbf02a747f0262eb296c93b4f2fdcde744675d5c232675e28348f452305d56422c2e6bdcf745973f91062ca72effcbd81556fe95c1d7480aa22848fd165cef44c8ee788d306400e3c74243b0d203180e9056c3fa75a360d6b9dddcf96e3af263315952c6fc39bdd6e5cd73a62ced53c36af135ab8d0f40ac1fcca67eaf6bf1ec886772266348c12816b45c09a4e9f6f6d34777f6893823d08e6efa20c8406081eea3c8facdd6019d2ef8c95254b43f3884f1efc81ec320153b5a58b5099f11a032a96aee1d22508432b290e577138051f9a82184075d8698e42d6e99acc07aac879a94d316d5b9263e25929d41ba63a6153f37c968f4854f920820a8ffd44c6c67b9595bff87a26060089d4e75f627eb3757cc7784f1727a0af94617a51894dd142f9fcf80a6abd529c4bf9fa9f4ad696024b2a431179f89cae6f4ea5fc25af2b3b71c60cf9e61d20a3d4dc4f95d115b57460ebb713183f7c35c49fd49e164f0194b2b63d4c1f637d5fa3f3c655ebd259628b14fcc5849096ebc3e9a507c66f9f356387d322667b6bf109799182910915f8dd543a99b787541c9de5bf50f94a292348518dc91e6d448775085bc65db75b36d345c58275cac9fbab026eaca64b1e19a2d6e6f8e3f0e53b9127dc92b3b7435941c2d6cc5c6b283f96ed0c21dabb3e6d7006b24f9c725d01b51c1c1b56bc26c539cf5601cebffd2d34f89253ef97b42fc1f495434098af272a8ff8f0b7269462f0c97b2e83ccc076aa8fb0565eee73a7b0c549c02ab555988d8dbc15171fc4260a0402c365fb741ef35c1c59b840f4ddbf4aa53a7555d20a62a925a287ab8ea60fd5b5dba8a3b8a433bed8e07e2bd0be1c340d4f15c7ab939835f84a82aac5c2bdfd6d7aa41e81f537d19877cbc71cc1c20271b4b64bb87877c0473ae03984f91402b0c7eca5e60411374b6f931a49769cb9d2dadde91936535e748a90b1e2e3f0fc1f3e3f4346608687a7f4fd0e1182939edef6183b5c88b4c2e6f60000000000000000000000000000000004060c15212c333b")
	sig5, _ := hex.DecodeString("2fcc2557412599dd8f39997823c72c13976054db47ed14ad4068ab3a34485da4da76ccff27f7edce29c9d137a0ac3c77419cdc054f070de33c6a916fd24d4fbad2ebfb7be6a275394e8aa277601127d9d54dd6314f30e7e0cc688ea3e9f3ea9c6a88bc7ee2aa18ab8ae68a9de1dc22ae103f1573ee71225069f60894304de55fa803ec81445caff3983ee48a3c7e1ea6526a4d19946d470e75af1d617e429ca232c04f016a7248db134b3b166d1777d7ef23844eb68692abfc861c6bd602264d7f0305b3093b16ae66b6569b879176e593b2bffda4f7e4463f89be6ac7b3abf13d847e052c0b4270a32d85f9c834883bf3c24b5762f8f62c3267794354cf7bdd05cc6d552296d805419646fe3e8a6138c4b4f15298801f156e84c3dae7483808b6488b60f9279f58647c3afa07365b8c360461ffcf7117b857f616f6105eb749e1f540b4b7a8ad8f935c6823834018b2bf2836720ab25ad71c25bd3ceea937b872aad5cc1823cb672e938c4829039bdf58305f73ecc5cfd7cd28c32cbf4e7a4715642b7fd0bc846dcc57483b0a8b1bc937ded9874c3fbfdffcd85157e1cf832ac2f5876f030640a86c6967eb3228247d2399dec047927fc999389911d65d59737c1385223c71d78c7f01f98ca46a89bcffdd7a853a73f8f229803b5a3392c8e609f16f5b08edc60c966ec34ea411db2bb1ca9ce65572a3ac1a6a78eccaccb6449bc66416d00964a9fa228921059ee703e3360a0e6057eebd88226256d4348c37306afde06319ee70c68d72de7e7a7531e0c054d713f4453c536c0d45acfdb4ad3db523e6d1884695ed1fff6bd23124d6a29520d269538d5e59297ecf31eb85bdd57ed0df427a551cc8c633001c9e5e774d8fa142d776e67629ca4444c5750bec6ec396698115f526eb3b82ca08a0c4e35cbc7f65bddeaa0bf9c643566f5d6a85205b606663942810e60fcce73be304f4e2718549127c6d1c1f42ce86bfb71a32464b721a44f95b1aea58d335d40b2df89c3b0e3621252b0d48db96fd99859db753c5ceb699be1b572415c197563728afedad2a29e7dc55a04054c861508bee02ab1dd3f831184a306b59b46dbd2bed084858d3d105f6f797ecc4acba97a1b5ee04609a037c5929a78eddec74a9e500bc3a7f2e23a6b67c6fddb1ffa70fe5797cca31db2b79ea06f5a755f1642b9914fd5a8e3cbe59041af4e19d98ac667aa427bd98e67c7169568ea9a131e2bec50551f1fd9f627f3fcc0a0ee5cb14410e455c38f6ab060235d193b969eff4ed68bc0cc62e8c14caf4967277fb5d72fec042b7c3b9a63b2fbd8940e6471e721af6fa9085f332ac1e05818f3fe8cb993cc25f5203ec57bc94be44376e0e2ae2c07f6948f3c6098db8d36e44173f3f45e806e4a27ab61c2f7d9900ba148abd3fd264ddc7bec3e5d4c6016a92c1995b153a41a3b5288ff2fb2ef5de02cbfdf325ba6fd2d5334aae81d15de90d6cd88600d5aef2a8e05046729b44a6c2d222d6c5384804bdf5f9a7bb4afbcc53fd97d03d5db7ee5a3d249f5ece3ea9f5717b440b80876ea9f73dbf8d37dc42d513ef8d8b125808232b7bfdfd7d605411eaba41200dd4126c2cc6c9b835bd85a070d521c8a6b1bbbfa0ede30a32fc9bfd29efe682386f275bdbee08c186b2de694cfe2c719c2607df3cd21daa1e4830c55e4a584aea45a1d967d1a5a940745ef5bd06345b426f7e4fc3afedab27e92fb46afc412a74314cc0457c3bac8f6355079870e0fefca928cee68bbac44f8b93e947da4e9e55f80c5a2caeecb24cab20c2d009571b502df520a0263a16d9cbe73f9d185edc45fd727209fd5cc9cb98437ab864d4a013fcd58ad3052029ba78b76f5a251c42b6a8c2ffeb6c76bef144ef9e2e7bdd0140172370cacaeb67cbaa9cf9e7f09732bf525c5a58747986a1405868a06c3de8ca0eb392cbd19507a1d8e3484e1eaba47a1f021da897d7491c3fab89f70ed3875bcd1d7eed9a509e893fd0a7c95d32e8e79203f406870c4eac989db628dbc61ac7fca3cfa602f22f82b8fd9ff866ce22bca9a877d58e1aaa445bb67d788c7ab2e83ace1bb8cedec3cbe8f28b0694dcb101254e1126186d9d800b89c3b31ba01eec83486ca3f4596ef658d6cec011c78d3f05d68af068199b613340c1340394528defe77d0250e56242a80bd9787bec36b97f3cba0dffb35bcafd3a8e36893f694bf2f1188f6c4752c811a5c53efae4055f2ab59303a9a26da81c24f811c3e79d2261b5519bf8d90202c11100ed740ef23613e4112cb6b67d1db0a0cf19ce54edd7f8787446393ed99332c5e25a251189eb71047c7c7d3ead7c474bf609af51ab5f976b8e39999295c9e1d134c6f7737431d14fc617e6839f91ea1dec10b2ea5f3b69d6941c9d1389db83d3e530689c702206c141ddc92d9442eee6d479307db81520905b0b915dbb16dc2ee3604a0a64e19f191a07459eb7fb8068c3dab1fd1d8f218cf255ca8c23430785b1d5aebe2ca367ac8a93dfda9cf663e5bbbc7436f002bdcda8328f09722ca689dce0214a86e34c9bd33a527af5ccbd58b91aeef27ff203a2eaa5165b58024aca46be98db0e509ddcb52e6345a5d974ca3a89360507166aadd72df12c5712b03c65ffa3059e54e38b202b6ef689694d754f521142d6977245c7f934c2f25306c50747aab1b767004c8fce78b28baef04bfaa15a3ab2978cd8079ac8d79ab10c87476ab50e6f29192a1ccde953d1e4ea9745c08202e91773c7483157c04ee8731832516ef519af1d0d46bc525f5586d6589629cf0b798cfe44b0b6238517418f38b70d402640b3d86c37c00a1e01a856f8ad2685a5f6a83badd854c3a7a3c713f3680290a9b09c87d6fa6867f1a0350d906a9d2367fe99762de754dec897b2abc025ce4f0f01660c22267f05fec0af86e90def94ba8e6479e233a74630fb337d4f5fe6b83b2aa4f9d5916699921d73dc79983d5344bc62cf642bd7ad9f1060468344ca78c756636949d2006309fd30af517b8d9a75ccffb50a305068ce4fbba1add4c71f956324411f22b2adf93e223e9874bbad5067b2306660d5bb0b59cb25fa892c2becd9705866ea5af5fb2648a70588582c1a8b215fe714dec19de232a7eeace68ae95c4eccade05456ac7f0f33972303c1249f46ae4649348400fb19e54922806f8f8385fab6450c47d189d2a6ddeb3f7530ca761096a0de32748a02f60ba204ac29ee5846ff8fd5af326462d6160eee96ecdccba935bb938bd2b18cfcb244fcf4994347dfd74faccada1bdb858e3b9100a3c05034a458a069f9754453c11bcbe0582267748c4d54ab87c77cbdc0d7c4c034a215206cfc227cf711d1a4bff92371ecaedfdf3cb767c7757971218a9bc9cd7b004798fcaa61cd7a33d734a066976fb17adee6186c2f57e748651fa470de58fd1de78f949d6e8130307a4b2f5610bd9281308238264b214719032e396f01e0b3775a85c073dbfda2cd3584074746bdf78be2e455b01a13646fec2daf189db79ec9eafdedeaec81f038fd804d3efaa4f96651b68615ccc8348d80189c1a946adfa0344be948a89b10435236ea80f3115b4e5ea449958cc70551edddfa24f117806b80bbac7424cfbe01bd36c4462363cbccab56298dccf831a4cc9486c1a72ddacf4f349ec0e0b8c87af4b929f09b6c51a1e9059cf44aa432914fe86c1123d501463be7d346976563caae6a9f88fe543d20c31175184d5f650c544e1c1f1da401ca28479bdaedc6aca8824bf04e7487ef34a40260054fc57cea2b242a6f965a1abe9046cb272822f72c9e786c7f11985b6b3954c4b0f6f61d2e64031412cce4aec489ca217249d6d01cb119226837a1d4dbcb3ef0c89e4538ce7d83a4044f40df56adbc1f2aa9da6084e83a1dff8dabb7ab5cdfa5f55bd78e4ada1749841e159595f91628f9ce065cc5b833730ec691164d440b94e26637c1f1ed1d170eb995132f3694487a631e5d017eccfea3d64a59a2d9bbb43dbc9d74c697a129e3ee5e7017308ad8910155e1adc8abf0cc24d2169f8a5fdd31bc5e64ec228363e17ba29365a3e03cd07d886a0aab59d809fe1e19877453bfe32b2846639de320b8d40f947b651f1ecf760a2f3fa8b9a05e2ab53644a20cf7be6dbb0df7e22eb231eeab16d3dba6d94c78dfc41742f45afa41bf5492009c1d680b21cb1766241a9768eea7de31113e9b9ad7aabbdf923d042c86fd3d117fee201611c6f86bd2d83050279c4ecd4bd0bb6afffd1adfbac9bbd0792a3707d329714068ebd992b4f0ad0f2e04b9698caa52383f6ef885e020a8c1a60d26e1ca44b582cadc46132e4d24a5688da0401af9738b42e2c2819a0daf4c1d3ad7cc47beabcbcf1f0ddfb23093c95e6a7c8459456e8deeff989aee8644db12f298cbe62b2baafb833a0dbc0347b5fa75feb3b1c9fe9efd3026c85897f1852f8a6181df9fc27a75833d3fafc0cfe3832b9265ed5d434d04967ab2deae7cef4daacd3d4846436bd6aec673bfc4f670d0d50153ed6566b3842f4e0cbe4647f52c2d2ff133dcf2b0e23498195386bf07fb9d4ea40d4d5038066629a2db4ee989acd57f639fb8b5c7fd6f74d9ae2c43ace278c8e231a93e81cc5947faebbd150d92af5c4d947a427c622222318ce0beb5651ee1e50857e259463c2ea269f932807a370023d95e9e5023c7cb6e52f94454d4875db9e71313cd395b9f92a342ce475ebe0e35feeb98c69f605a143e3430b499669708d35635a41229361d448ae1e95492e386eaf8a02bfff9cb6e1dfb834b75c163b0941967b5b36a15e5abf4f67128071a231f8a35a4cb1d5fffd0c56b8724fa260489088f278d4a9ddb4b157a5afe772c1438703f5f56fb797eaa4dcb37c23942a21db1ca70834798187e9d8015a79916f9e37f79eb3ac3bedf3326dceb0bd75f33178458cb838eebe06fb6d012fb7cd1394ac59223720247213bbc3d718fd8585f927721ab706efc53b6d8a2ef420dd0bdb8cb79fff3f9c4e316a4d01c8c0142b85038b299f30cb33746cd7a91bb2f741ab4e462985e754b8448727cd041484aee6a19d1e05568122657a7db760b467d2497da6d46f3034a709aa41d153bfb8bef4ea40cf3f53eb416b12563705f0eb8e3b9bebf623b3eb7baebc0947627497270605f40a4a7b2ddc8b70a0627ed15e8981a0ce1c08d389fef8e6e2b5639f650cd0d55e03443170fe2529ef1045b6d3e8963f29c40bb8be03b9cf50feb5592bb346a2497ca069810eafd88f2562f0e48a5daff72762f9c5cc9db60072ae1ac917ffc72af902e3c66815760aefa806066c3033834ec4dff5aa1f058fef2aecabb8318b276a66e5cf5b866244f437c5ac5a240aea909ff72415a23cbdf948aeeef2c852ab340d225c0e5dc13e51ff47aee58bbca930bfbd2251ef194e20aa1905bd8b4a05ba40e174f85658a30e0a663a1abc8e940126f30b6ea1c9736a98da65156580d7a388ee24b7943466bd167f69012d5f53bf03044e26b32ab0ec3d121ec60e183abb1cb264e49c0331a2955213923121f9642e70bcdf3b93510172870a4245992abc2fdaab2731a0adfed7613d39b9b9e7304accdfeaa99ae21e206a02f77ee55511f08d853b84d5d3df398cb0c3330b35a1bdd53044b84f66bcdd0fd72a64daf7b20317b94d3621f1359192a00554d7d3a833b3d58393dad968035d12dad7d07382958a32c09aaaf3751f276473a335df180b247fafcc3e2bee2bf09aed41b4a84e216a2ca968f4aef2d3044cfa84e9a83b5e73182a60801d946bfc65b68151fe91d014c8221ead8ac8efc0a49f9da36218773f5304eb1933b9820fefce6d9b88970747b648d15e7c1fc84268a5bacd54cb56737c08e019679019fb3ad68ebc37d95063bf0df9cdc587f4397e0b29d4e88325a4167dfd22bb9944347e2395b7d125606dc71ca5e62d7b0773df8581ae38eab813771b93c5a486270a69c47022460c62eabd79bab121bced95ae6396ba3bad2b4cbb7a0e1ac818e1358567b8d915b01f741bde66f2efa3027b2aba756b1d2e2433d6516f0634b4b9d151232f1fcd3ac283c1d48924b2fdaab1d254f0c1385017aec8b090a626e3a67a96d889641594e2abd85bcb46393055d01dc825068dd384f629b430c550827e279061f954bf3589eb8793a988c83c090e5962d566b11ca893a0c65cc8b1e6083a66da6c386b0e451f3a3ade5e47be346f9587721b99f0e70d0d62d560b36a1ab863ceebde88aeb057d42605e7eae6bec0039517056aa588cef986b6336fb7823c1d1af3d351b90e9cdb4224281c347f27b8548e0e8c8ae9b6cf1d2fa7a0be8c5cf49e8687dff8476ad012cee748e2453d1d56bce3a56a80a9a8f6d48363a0e48c525366234dd0ca2bd3249515664bbbceefa0d19212b3b7682b9f301373eda092f434ba5dfe2f30d47b9c0de3261a0cb0494d3000000000000000000000000000000000000000000000000000000000000030c151921262a2d")

	tests := []struct {
		name          string
		atts          []*zondpb.Attestation
		wantAtts      []*zondpb.Attestation
		keys          []int
		coverage      *bitfield.Bitlist64
		wantTargetIdx int
		wantErr       string
	}{
		{
			name:          "nil attestation",
			wantTargetIdx: 0,
			wantErr:       ErrInvalidAttestationCount.Error(),
			keys:          []int{0, 1, 2},
		},
		{
			name: "single attestation",
			atts: []*zondpb.Attestation{
				{},
			},
			wantTargetIdx: 0,
			wantErr:       ErrInvalidAttestationCount.Error(),
			keys:          []int{0, 1, 2},
		},
		{
			name:          "no keys",
			wantTargetIdx: 0,
			wantErr:       ErrInvalidAttestationCount.Error(),
		},
		{
			name: "two attestations, none selected",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
			},
			wantTargetIdx: 0,
			wantErr:       ErrInvalidAttestationCount.Error(),
			keys:          []int{},
		},
		{
			name: "two attestations, one selected",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x00}},
				{AggregationBits: bitfield.Bitlist{0x01}},
			},
			wantTargetIdx: 0,
			wantErr:       ErrInvalidAttestationCount.Error(),
			keys:          []int{0},
		},
		{
			name: "two attestations, both selected, empty coverage",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0b00000001, 0b1}, Signatures: [][]byte{}},
				{AggregationBits: bitfield.Bitlist{0b00000110, 0b1}, Signatures: [][]byte{}},
			},
			wantAtts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0b00000111, 0b1}, Signatures: [][]byte{}},
				{AggregationBits: bitfield.Bitlist{0b00000110, 0b1}, Signatures: [][]byte{}},
			},
			wantTargetIdx: 0,
			wantErr:       "invalid or empty coverage",
			keys:          []int{0, 1},
		},
		{
			name: "two attestations, both selected",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000001, 0b1}, Signatures: [][]byte{sig0}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000010, 0b1}, Signatures: [][]byte{sig1}},
			},
			wantAtts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000011, 0b1}, Signatures: [][]byte{sig0, sig1}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000010, 0b1}, Signatures: [][]byte{sig1}},
			},
			wantTargetIdx: 0,
			keys:          []int{0, 1},
			coverage: func() *bitfield.Bitlist64 {
				b, err := bitfield.NewBitlist64FromBytes(64, []byte{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000011})
				if err != nil {
					t.Fatal(err)
				}
				return b
			}(),
		},
		{
			name: "many attestations, several selected",
			atts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000001, 0b1}, Signatures: [][]byte{sig0}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000010, 0b1}, Signatures: [][]byte{sig1}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000100, 0b1}, Signatures: [][]byte{sig2}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00001000, 0b1}, Signatures: [][]byte{sig3}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00010000, 0b1}, Signatures: [][]byte{sig4}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00100000, 0b1}, Signatures: [][]byte{sig5}},
			},
			wantAtts: []*zondpb.Attestation{
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000001, 0b1}, Signatures: [][]byte{sig0}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00010110, 0b1}, Signatures: [][]byte{sig1, sig2, sig4}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00000100, 0b1}, Signatures: [][]byte{sig2}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00001000, 0b1}, Signatures: [][]byte{sig3}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00010000, 0b1}, Signatures: [][]byte{sig4}},
				{AggregationBits: bitfield.Bitlist{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00100000, 0b1}, Signatures: [][]byte{sig5}},
			},
			wantTargetIdx: 1,
			keys:          []int{1, 2, 4},
			coverage: func() *bitfield.Bitlist64 {
				b, err := bitfield.NewBitlist64FromBytes(64, []byte{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0b00010110})
				if err != nil {
					t.Fatal(err)
				}
				return b
			}(),
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			gotTargetIdx, err := aggregateAttestations(tt.atts, tt.keys, tt.coverage)
			if tt.wantErr != "" {
				assert.ErrorContains(t, tt.wantErr, err)
				return
			} else {
				assert.NoError(t, err)
			}
			assert.Equal(t, tt.wantTargetIdx, gotTargetIdx)
			extractBitlists := func(atts []*zondpb.Attestation) []bitfield.Bitlist {
				bl := make([]bitfield.Bitlist, len(atts))
				for i, att := range atts {
					bl[i] = att.AggregationBits
				}
				return bl
			}
			extractSignatures := func(atts []*zondpb.Attestation) [][]byte {
				sigs := make([][]byte, 0)
				for _, att := range atts {
					sigs = append(sigs, att.Signatures...)
				}
				return sigs
			}

			assert.DeepEqual(t, extractBitlists(tt.atts), extractBitlists(tt.wantAtts))
			assert.DeepEqual(t, extractSignatures(tt.atts), extractSignatures(tt.wantAtts))
		})
	}
}
